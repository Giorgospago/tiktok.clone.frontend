<ion-header>
    <ion-toolbar>
        <ion-title>{{ audio?.name || "Audio file" }}</ion-title>
    </ion-toolbar>
</ion-header>

<ion-content>
    <ng-container *ngIf="audio">
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <div class="d-flex p-3" *ngIf="audio">
                        <div class="flex-shrink-0">
                            <ng-container *ngIf="audio.meta?.spotify?.album?.images?.[0]?.url else noImageAvailable">
                                <img
                                    [src]="audio.meta.spotify.album.images[0].url"
                                    class="img-thumbnail"
                                    width="180"
                                />
                            </ng-container>
                            <ng-template #noImageAvailable>
                                no image available
                            </ng-template>
                        </div>
                        <div class="flex-grow-1 row ps-3">
                            <div class="col-12">{{ audio.name }}</div>
                            <div class="col-12">
                                <span class="badge bg-secondary my-1 me-1" *ngFor="let badge of badges">{{ badge }}</span>
                            </div>
                            <div class="col-12">

                                <ng-container *ngIf="links.spotify">
                                    <a [href]="links.spotify" target="_blank" class="me-3">
                                        <svg style="height: 30px; fill: var(--color-spotify);" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512">
                                            <path d="M248 8C111.1 8 0 119.1 0 256s111.1 248 248 248 248-111.1 248-248S384.9 8 248 8zm100.7 364.9c-4.2 0-6.8-1.3-10.7-3.6-62.4-37.6-135-39.2-206.7-24.5-3.9 1-9 2.6-11.9 2.6-9.7 0-15.8-7.7-15.8-15.8 0-10.3 6.1-15.2 13.6-16.8 81.9-18.1 165.6-16.5 237 26.2 6.1 3.9 9.7 7.4 9.7 16.5s-7.1 15.4-15.2 15.4zm26.9-65.6c-5.2 0-8.7-2.3-12.3-4.2-62.5-37-155.7-51.9-238.6-29.4-4.8 1.3-7.4 2.6-11.9 2.6-10.7 0-19.4-8.7-19.4-19.4s5.2-17.8 15.5-20.7c27.8-7.8 56.2-13.6 97.8-13.6 64.9 0 127.6 16.1 177 45.5 8.1 4.8 11.3 11 11.3 19.7-.1 10.8-8.5 19.5-19.4 19.5zm31-76.2c-5.2 0-8.4-1.3-12.9-3.9-71.2-42.5-198.5-52.7-280.9-29.7-3.6 1-8.1 2.6-12.9 2.6-13.2 0-23.3-10.3-23.3-23.6 0-13.6 8.4-21.3 17.4-23.9 35.2-10.3 74.6-15.2 117.5-15.2 73 0 149.5 15.2 205.4 47.8 7.8 4.5 12.9 10.7 12.9 22.6 0 13.6-11 23.3-23.2 23.3z"/>
                                        </svg>
                                    </a>
                                </ng-container>
                                <ng-container *ngIf="links.apple">
                                    <a [href]="links.apple" target="_blank" class="me-3">
                                        <svg style="height: 30px; fill: var(--color-apple);" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512">
                                            <path d="M318.7 268.7c-.2-36.7 16.4-64.4 50-84.8-18.8-26.9-47.2-41.7-84.7-44.6-35.5-2.8-74.3 20.7-88.5 20.7-15 0-49.4-19.7-76.4-19.7C63.3 141.2 4 184.8 4 273.5q0 39.3 14.4 81.2c12.8 36.7 59 126.7 107.2 125.2 25.2-.6 43-17.9 75.8-17.9 31.8 0 48.3 17.9 76.4 17.9 48.6-.7 90.4-82.5 102.6-119.3-65.2-30.7-61.7-90-61.7-91.9zm-56.6-164.2c27.3-32.4 24.8-61.9 24-72.5-24.1 1.4-52 16.4-67.9 34.9-17.5 19.8-27.8 44.3-25.6 71.9 26.1 2 49.9-11.4 69.5-34.3z"/>
                                        </svg>
                                    </a>
                                </ng-container>
                                <ng-container *ngIf="links.all">
                                    <a [href]="links.all" target="_blank">
                                        <svg style="height: 30px; fill: var(--color-apple);" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                            <path d="M352 256C352 278.2 350.8 299.6 348.7 320H163.3C161.2 299.6 159.1 278.2 159.1 256C159.1 233.8 161.2 212.4 163.3 192H348.7C350.8 212.4 352 233.8 352 256zM503.9 192C509.2 212.5 512 233.9 512 256C512 278.1 509.2 299.5 503.9 320H380.8C382.9 299.4 384 277.1 384 256C384 234 382.9 212.6 380.8 192H503.9zM493.4 160H376.7C366.7 96.14 346.9 42.62 321.4 8.442C399.8 29.09 463.4 85.94 493.4 160zM344.3 160H167.7C173.8 123.6 183.2 91.38 194.7 65.35C205.2 41.74 216.9 24.61 228.2 13.81C239.4 3.178 248.7 0 256 0C263.3 0 272.6 3.178 283.8 13.81C295.1 24.61 306.8 41.74 317.3 65.35C328.8 91.38 338.2 123.6 344.3 160H344.3zM18.61 160C48.59 85.94 112.2 29.09 190.6 8.442C165.1 42.62 145.3 96.14 135.3 160H18.61zM131.2 192C129.1 212.6 127.1 234 127.1 256C127.1 277.1 129.1 299.4 131.2 320H8.065C2.8 299.5 0 278.1 0 256C0 233.9 2.8 212.5 8.065 192H131.2zM194.7 446.6C183.2 420.6 173.8 388.4 167.7 352H344.3C338.2 388.4 328.8 420.6 317.3 446.6C306.8 470.3 295.1 487.4 283.8 498.2C272.6 508.8 263.3 512 255.1 512C248.7 512 239.4 508.8 228.2 498.2C216.9 487.4 205.2 470.3 194.7 446.6H194.7zM190.6 503.6C112.2 482.9 48.59 426.1 18.61 352H135.3C145.3 415.9 165.1 469.4 190.6 503.6V503.6zM321.4 503.6C346.9 469.4 366.7 415.9 376.7 352H493.4C463.4 426.1 399.8 482.9 321.4 503.6V503.6z"/>
                                        </svg>
                                    </a>
                                </ng-container>

                            </div>
                            <div class="col-12" *ngIf="audioPreview">
                                <audio controls [src]="audioPreview"></audio>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row mt-3" *ngIf="youtube">
                <div class="col-12">
                    <div>
                        <div class="ratio ratio-16x9">
                            <iframe [src]="('https://www.youtube.com/embed/' + youtube + '?rel=0') | safe: 'resourceUrl'" allowfullscreen></iframe>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row mt-3" *ngIf="lyrics">
                <div class="col-12">
                    <div class="overflow-hidden" [style.height]="toggleLyrics ? 'auto' : '230px'">
                        <p class="text-break-spaces" [innerHTML]="lyrics"></p>
                    </div>
                    <div class="text-center py-2 cursor-pointer" (click)="toggleLyrics = !toggleLyrics">
                        See more
                        <ion-icon
                            class="position-relative"
                            style="top: 2px"
                            [name]="toggleLyrics ? 'chevron-up-outline' : 'chevron-down-outline'"
                        ></ion-icon>
                    </div>
                </div>
            </div>

            <div class="row mt-3">
                <div class="col-12">
                    <app-video-wall [posts]="posts"></app-video-wall>
                </div>
            </div>
        </div>

        <div style="height: 100px;"></div>


        <ion-fab vertical="bottom" horizontal="center" slot="fixed">
            <ion-fab-button [routerLink]="['/create']" [queryParams]="{audio: audioId}" id="fab-sound" color="danger">
                <ion-icon name="musical-notes-outline"></ion-icon>
                <ion-text>Use this sound</ion-text>
            </ion-fab-button>
        </ion-fab>
    </ng-container>
</ion-content>
